<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaxiA-CIMCO - Motoparrillero</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/4a58b8d0c2.js" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center justify-center min-h-screen">

    <div id="modal-container" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div id="modal-content" class="bg-white p-6 rounded-lg shadow-lg max-w-sm w-full mx-4 text-center">
            <!-- El contenido del modal se inserta aquí dinámicamente -->
        </div>
    </div>

    <div class="bg-white rounded-xl shadow-lg p-6 w-full max-w-sm mx-4 my-8">
        <!-- Header -->
        <div class="flex flex-col items-center mb-6">
            <h1 class="text-3xl font-bold text-blue-600">TaxiA-CIMCO</h1>
            <p class="text-gray-500 mt-1">App de Motoparrillero</p>
        </div>

        <!-- Secciones de la App -->
        <div id="app-sections" class="space-y-4">
            <!-- Sección de Solicitudes -->
            <div id="requests-section" class="bg-gray-50 p-4 rounded-lg shadow-inner">
                <h2 class="text-xl font-semibold text-gray-700 mb-4 text-center">Solicitudes de Servicio</h2>
                <div id="request-list" class="space-y-4">
                    <!-- Aquí se cargarán las solicitudes de servicio dinámicamente -->
                    <div class="bg-white p-4 rounded-lg shadow-md border border-gray-200">
                        <p class="text-gray-700 font-medium">Pasajero: Ana Torres</p>
                        <p class="text-gray-500 text-sm">Cantidad de Pasajeros: 2</p>
                        <p class="text-gray-500 text-sm mt-1">Recogida: Requerida por GPS</p>
                        <p class="text-gray-500 text-sm">Texto Adicional: Por favor esperar en la esquina.</p>
                        <div class="flex justify-end space-x-2 mt-4">
                            <button onclick="acceptRequest()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full transition-colors duration-200">
                                Aceptar
                            </button>
                            <button onclick="rejectRequest()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full transition-colors duration-200">
                                Rechazar
                            </button>
                        </div>
                    </div>
                </div>
                <p id="no-requests-msg" class="text-center text-gray-400 mt-4 hidden">No hay solicitudes nuevas.</p>
            </div>

            <!-- Sección de Información de Crédito -->
            <div id="credit-section" class="bg-gray-50 p-4 rounded-lg shadow-inner">
                <h2 class="text-xl font-semibold text-gray-700 mb-4 text-center">Crédito Disponible</h2>
                <div class="text-center">
                    <p class="text-3xl font-bold text-green-600">$<span id="credit-balance">10000</span></p>
                    <p class="text-sm text-gray-500 mt-1">Costo por servicio: $200</p>
                </div>
                <div class="flex justify-center mt-4 space-x-2">
                    <button onclick="addCredit()" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-full transition-colors duration-200">
                        Añadir Crédito
                    </button>
                    <button onclick="viewTransactions()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-full transition-colors duration-200">
                        Historial
                    </button>
                </div>
            </div>

            <!-- Sección de Chat -->
            <div id="chat-section" class="bg-gray-50 p-4 rounded-lg shadow-inner">
                <h2 class="text-xl font-semibold text-gray-700 mb-4 text-center">Chat</h2>
                <div id="chat-messages" class="bg-white h-48 overflow-y-auto p-4 rounded-lg shadow-md mb-4 flex flex-col space-y-2">
                    <!-- Mensajes de chat -->
                    <div class="flex justify-start">
                        <div class="bg-blue-100 p-2 rounded-lg text-sm text-gray-800">Hola, ¿ya estás en camino?</div>
                    </div>
                    <div class="flex justify-end">
                        <div class="bg-blue-600 text-white p-2 rounded-lg text-sm">Sí, ya casi llego.</div>
                    </div>
                </div>
                <div class="flex">
                    <input type="text" id="chat-input" placeholder="Escribe un mensaje..." class="flex-1 p-2 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <button onclick="sendMessage()" class="bg-blue-600 text-white p-2 rounded-r-lg hover:bg-blue-700 transition-colors duration-200">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Botón de Cerrar Sesión -->
        <div class="mt-6 flex justify-center">
            <button onclick="showLogoutModal()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-full transition-colors duration-200 shadow-md">
                Cerrar Sesión
            </button>
        </div>
    </div>

    <script>
        // Funciones para el modal
        function showModal(title, message, isConfirm = false, onConfirm = null) {
            const modalContainer = document.getElementById('modal-container');
            const modalContent = document.getElementById('modal-content');
            modalContent.innerHTML = `
                <h3 class="text-2xl font-bold mb-4">${title}</h3>
                <p class="text-gray-600 mb-6">${message}</p>
                ${isConfirm ? `
                    <div class="flex justify-center space-x-4">
                        <button id="confirm-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-full transition-colors duration-200">Confirmar</button>
                        <button id="cancel-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-6 rounded-full transition-colors duration-200">Cancelar</button>
                    </div>
                ` : `
                    <button id="close-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition-colors duration-200">Cerrar</button>
                `}
            `;
            modalContainer.classList.remove('hidden');
            modalContainer.classList.add('flex');

            if (isConfirm) {
                document.getElementById('confirm-btn').onclick = () => {
                    onConfirm();
                    hideModal();
                };
                document.getElementById('cancel-btn').onclick = hideModal;
            } else {
                document.getElementById('close-btn').onclick = hideModal;
            }

            modalContainer.onclick = (event) => {
                if (event.target === modalContainer) {
                    hideModal();
                }
            };
        }

        function hideModal() {
            const modalContainer = document.getElementById('modal-container');
            modalContainer.classList.add('hidden');
            modalContainer.classList.remove('flex');
        }

        // Simulación de funciones de la app
        function acceptRequest() {
            showModal("Servicio Aceptado", "Has aceptado el servicio. Ahora verás los detalles completos en tu pantalla.");
            // Lógica para mostrar los detalles completos del viaje
        }

        function rejectRequest() {
            showModal("Servicio Rechazado", "Has rechazado el servicio. Se buscará otro conductor.");
        }

        function addCredit() {
            showModal("Añadir Crédito", "Próximamente podrás añadir crédito a través de Nequi. Por ahora, puedes hacerlo de forma manual con tu despachador.");
        }

        function viewTransactions() {
            showModal("Historial de Crédito", "Aquí verás un historial de todos tus pagos y los créditos descontados por cada servicio.");
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (message) {
                const chatMessages = document.getElementById('chat-messages');
                const messageDiv = document.createElement('div');
                messageDiv.className = 'flex justify-end';
                messageDiv.innerHTML = `<div class="bg-blue-600 text-white p-2 rounded-lg text-sm">${message}</div>`;
                chatMessages.appendChild(messageDiv);
                input.value = '';
                chatMessages.scrollTop = chatMessages.scrollHeight; // Scroll to the bottom
            }
        }
        
        function showLogoutModal() {
            showModal("Cerrar Sesión", "¿Estás seguro que deseas cerrar la sesión?", true, logout);
        }

        function logout() {
            // Lógica de cierre de sesión
            console.log("Sesión cerrada. Redirigiendo a la pantalla de inicio de sesión.");
            showModal("Sesión Cerrada", "Has cerrado sesión correctamente.");
            setTimeout(() => {
                window.location.href = "login.html"; // Ejemplo de redirección
            }, 1000);
        }
    </script>
</body>
</html>
